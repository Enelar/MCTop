<script type="text/javascript">
phoxy =
{
  wait: true,
  config: "/api/phoxy",
  skip_initiation: location.pathname != "/",  
  OnWaiting: function()
  {
    phoxy._EarlyStage.async_require[1] = "/core/libs/phoxy/libs/jquery.form.js";
    phoxy._EarlyStage.async_require[2] = "/core/libs/phoxy/libs/EJS/ejs.js";
    phoxy._EarlyStage.EntryPoint();
  },
  OnBeforeCompile: function()
  {
    phoxy.config['api_dir'] = '/' + phoxy.config['api_dir'];
  },
  OnAfterCompile: function()
  {
    phoxy.plugin.breadcrumbs = {Origin_ApiAnswer: phoxy.ApiAnswer, await: true};

    phoxy.ApiAnswer = function()
    {
      var args = arguments;

      function DeferInit()
      {
        if (phoxy.plugin.breadcrumbs.await)
          return phoxy.Defer(arguments.callee, 100);
        breadcrumbs.TryApply(args[0]);
      }

      DeferInit();

      phoxy.plugin.breadcrumbs.Origin_ApiAnswer.apply(phoxy, arguments)
    }

    phoxy.Defer(function()
    {
      if (typeof breadcrumbs == 'undefined' || typeof breadcrumbs.canvas == 'undefined')
        return phoxy.Defer(arguments.callee, 100);
      phoxy.ApiAnswer = phoxy.plugin.breadcrumbs.Origin_ApiAnswer;
      breadcrumbs.init();
      phoxy.plugin.breadcrumbs.await = false;
    }, 100);
  },
  OnInitialClientCodeComplete: function()
  {
    function CoolCB()
    {
      requirejs.config({baseUrl: phoxy.Config()['js_dir']});

      phoxy.ChangeHash = function()
      {
        return false;
      }
    }

    if (location.pathname != "/")
      phoxy.ApiRequest(location.pathname + location.search, undefined, CoolCB());
    else
      CoolCB();
  }
}
</script>
<script phoxy="Main" data-main="/core/libs/phoxy/phoxy" src="/core/libs/phoxy/libs/require.js" type="text/javascript"></script>